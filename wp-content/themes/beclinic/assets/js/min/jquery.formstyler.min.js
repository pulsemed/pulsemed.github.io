!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){"use strict";function d(b,d){this.element=b,this.options=a.extend({},c,d),this.init()}function e(c){if(!a(c.target).parents().hasClass("jq-selectbox")&&"OPTION"!=c.target.nodeName&&a("div.jq-selectbox.opened").length){var d=a("div.jq-selectbox.opened"),e=a("div.jq-selectbox__search input",d),f=a("div.jq-selectbox__dropdown",d),g=d.find("select").data("_"+b).options;g.onSelectClosed.call(d),e.length&&e.val("").keyup(),f.hide().find("li.sel").addClass("selected"),d.removeClass("focused opened dropup dropdown"),d.parents("p").removeClass("active")}}var b="styler",c={idSuffix:"-styler",filePlaceholder:"",fileBrowse:"",fileNumber:"",selectPlaceholder:"",selectSearch:!1,selectSearchLimit:10,selectSearchNotFound:"",selectSearchPlaceholder:"",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:!0,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};d.prototype={init:function(){function g(){void 0!==b.attr("id")&&""!==b.attr("id")&&(this.id=b.attr("id")+c.idSuffix),this.title=b.attr("title"),this.classes=b.attr("class"),this.data=b.data()}var b=a(this.element),c=this.options,d=!(!navigator.userAgent.match(/(iPad|iPhone|iPod)/i)||navigator.userAgent.match(/(Windows\sPhone)/i)),f=!(!navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/(Windows\sPhone)/i));if(b.is("select")){var h=function(){function h(b){b.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(b){var c=null;"mousewheel"==b.type?c=b.originalEvent.wheelDelta*-1:"DOMMouseScroll"==b.type&&(c=40*b.originalEvent.detail),c&&(b.stopPropagation(),b.preventDefault(),a(this).scrollTop(c+a(this).scrollTop()))})}function k(){for(var a=0;a<i.length;a++){var b=i.eq(a),d="",e="",f="",g="",h="",k="",l="",m="",n="",o="disabled",p="selected sel disabled";b.prop("selected")&&(e="selected sel"),b.is(":disabled")&&(e=o),b.is(":selected:disabled")&&(e=p),void 0!==b.attr("id")&&""!==b.attr("id")&&(g=' id="'+b.attr("id")+c.idSuffix+'"'),void 0!==b.attr("title")&&""!==i.attr("title")&&(h=' title="'+b.attr("title")+'"'),void 0!==b.attr("class")&&(l=" "+b.attr("class"),n=' data-jqfs-class="'+b.attr("class")+'"');var q=b.data();for(var r in q)""!==q[r]&&(k+=" data-"+r+'="'+q[r]+'"');e+l!==""&&(f=' class="'+e+l+'"'),d="<li"+n+k+f+h+g+">"+b.html()+"</li>",b.parent().is("optgroup")&&(void 0!==b.parent().attr("class")&&(m=" "+b.parent().attr("class")),d="<li"+n+k+' class="'+e+l+" option"+m+'"'+h+g+">"+b.html()+"</li>",b.is(":first-child")&&(d='<li class="optgroup'+m+'">'+b.parent().attr("label")+"</li>"+d)),j+=d}}function l(){var d=new g,f="",l=b.data("placeholder"),m=b.data("search"),n=b.data("search-limit"),o=b.data("search-not-found"),p=b[0][0].textContent,q=b.data("z-index"),r=b.data("smart-positioning");void 0===l&&(l=c.selectPlaceholder),void 0!==m&&""!==m||(m=c.selectSearch),void 0!==n&&""!==n||(n=c.selectSearchLimit),void 0!==o&&""!==o||(o=c.selectSearchNotFound),void 0===p&&(p=c.selectSearchPlaceholder),void 0!==q&&""!==q||(q=c.singleSelectzIndex),void 0!==r&&""!==r||(r=c.selectSmartPositioning);var s=a('<div class="jq-selectbox jqselect"><div class="jq-selectbox__select" style="position: relative"><div class="jq-selectbox__select-text"></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>').css({display:"inline-block",position:"relative",zIndex:q}).attr({id:d.id,title:d.title}).addClass(d.classes).data(d.data);b.css({margin:0,padding:0}).after(s).prependTo(s);var t=a("div.jq-selectbox__select",s),u=a("div.jq-selectbox__select-text",s),v=i.filter(":selected"),w=s.parents("p");k(),m&&(f='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+p+'"></div><div class="jq-selectbox__not-found">'+o+"</div>");var x=a('<div class="jq-selectbox__dropdown" style="position: absolute">'+f+'<ul class="jq-selectbox__dropdown-ul" style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+j+"</ul></div>");s.append(x);var y=a("ul",x),z=a("li",x),A=a("input",x),B=a("div.jq-selectbox__not-found",x).hide();z.length<n&&A.parent().hide(),""===i.first().text()&&i.first().is(":selected")?u.text(p).addClass("placeholder"):u.text(v.text());var C=0,D=0;if(z.css({display:"inline-block"}),z.each(function(){var b=a(this);b.innerWidth()>C&&(C=b.innerWidth(),D=b.width())}),z.css({display:""}),u.is(".placeholder")&&u.width()>C)u.width(u.width());else{var E=s.clone().appendTo("body").width("auto"),F=E.outerWidth();E.remove(),F==s.outerWidth()&&u.width(D)}C>s.width()&&x.width(C),""===i.first().text()&&""!==b.data("placeholder")&&z.first().hide(),b.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var G=s.outerHeight(!0),H=A.parent().outerHeight(!0),I=y.css("max-height"),J=z.filter(".selected");J.length<1&&z.first().addClass("selected sel"),void 0===z.data("li-height")&&z.data("li-height",z.outerHeight());var K=x.css("top");if("auto"==x.css("left")&&x.css({left:0}),"auto"==x.css("top")&&(x.css({top:G}),K=G),x.hide(),J.length&&(i.first().text()!=v.text()&&s.addClass("changed"),s.data("jqfs-class",J.data("jqfs-class")),s.addClass(J.data("jqfs-class"))),b.is(":disabled"))return s.addClass("disabled"),!1;t.click(function(){a("div.jq-selectbox").filter(".opened").length&&c.onSelectClosed.call(a("div.jq-selectbox").filter(".opened")),w.addClass("active"),b.focus();var d=a(window),e=z.data("li-height"),f=s.offset().top,g=d.height()-G-(f-d.scrollTop()),j=b.data("visible-options");void 0!==j&&""!==j||(j=c.selectVisibleOptions);var k=5*e,l=e*j;j>0&&j<6&&(k=l),0===j&&(l="auto");var m=function(){x.height("auto").css({bottom:"auto",top:K});var a=function(){y.css("max-height",Math.floor((g-20-H)/e)*e)};a(),y.css("max-height",l),"none"!=I&&y.css("max-height",I),g<x.outerHeight()+20&&a()},n=function(){x.height("auto").css({top:"auto",bottom:K});var a=function(){y.css("max-height",Math.floor((f-d.scrollTop()-20-H)/e)*e)};a(),y.css("max-height",l),"none"!=I&&y.css("max-height",I),f-d.scrollTop()-20<x.outerHeight()+20&&a()};r===!0||1===r?g>k+H+20?(m(),s.removeClass("dropup").addClass("dropdown")):(n(),s.removeClass("dropdown").addClass("dropup")):r!==!1&&0!==r||g>k+H+20&&(m(),s.removeClass("dropup").addClass("dropdown")),s.offset().left+x.outerWidth()>d.width()&&x.css({left:"auto",right:0}),a("div.jqselect").css({zIndex:q-1}).removeClass("opened"),s.css({zIndex:q}),x.is(":hidden")?(a("div.jq-selectbox__dropdown:visible").hide(),x.show(),s.addClass("opened focused"),c.onSelectOpened.call(s)):(x.hide(),s.removeClass("opened dropup dropdown"),s.parents("p").removeClass("active"),a("div.jq-selectbox").filter(".opened").length&&c.onSelectClosed.call(s)),A.length&&(A.val("").keyup(),B.hide(),A.keyup(function(){var c=a(this).val();z.each(function(){a(this).html().match(new RegExp(".*?"+c+".*?","i"))?a(this).show():a(this).hide()}),""===i.first().text()&&""!==b.data("placeholder")&&z.first().hide(),z.filter(":visible").length<1?B.show():B.hide()})),z.filter(".selected").length&&(""===b.val()?y.scrollTop(0):(y.innerHeight()/e%2!==0&&(e/=2),y.scrollTop(y.scrollTop()+z.filter(".selected").position().top-y.innerHeight()/2+e))),h(y)}),z.hover(function(){a(this).siblings().removeClass("selected")});var L=z.filter(".selected").text();z.filter(":not(.disabled):not(.optgroup)").click(function(){b.focus();var d=a(this),e=d.text();if(!d.is(".selected")){var f=d.index();f-=d.prevAll(".optgroup").length,d.addClass("selected sel").siblings().removeClass("selected sel"),i.prop("selected",!1).eq(f).prop("selected",!0),L=e,u.text(e),s.data("jqfs-class")&&s.removeClass(s.data("jqfs-class")),s.data("jqfs-class",d.data("jqfs-class")),s.addClass(d.data("jqfs-class")),b.change()}x.hide(),s.removeClass("opened dropup dropdown"),s.parents("p").removeClass("active"),c.onSelectClosed.call(s)}),x.mouseout(function(){a("li.sel",x).addClass("selected")}),b.on("change.styler",function(){u.text(i.filter(":selected").text()).removeClass("placeholder"),z.removeClass("selected sel").not(".optgroup").eq(b[0].selectedIndex).addClass("selected sel"),i.first().text()!=z.filter(".selected").text()?s.addClass("changed"):s.removeClass("changed")}).on("focus.styler",function(){s.addClass("focused"),a("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div.jq-selectbox__dropdown").hide().parents("p").removeClass("active")}).on("blur.styler",function(){s.removeClass("focused")}).on("keydown.styler keyup.styler",function(a){var d=z.data("li-height");""===b.val()?u.text(l).addClass("placeholder"):u.text(i.filter(":selected").text()),z.removeClass("selected sel").not(".optgroup").eq(b[0].selectedIndex).addClass("selected sel"),38!=a.which&&37!=a.which&&33!=a.which&&36!=a.which||(""===b.val()?y.scrollTop(0):y.scrollTop(y.scrollTop()+z.filter(".selected").position().top)),40!=a.which&&39!=a.which&&34!=a.which&&35!=a.which||y.scrollTop(y.scrollTop()+z.filter(".selected").position().top-y.innerHeight()+d),13==a.which&&(a.preventDefault(),x.hide(),s.removeClass("opened dropup dropdown"),c.onSelectClosed.call(s))}).on("keydown.styler",function(a){32==a.which&&(a.preventDefault(),t.click())}),e.registered||(a(document).on("click",e),e.registered=!0)}function m(){var c=new g,d=a('<div class="jq-select-multiple jqselect"></div>').css({display:"inline-block",position:"relative"}).attr({id:c.id,title:c.title}).addClass(c.classes).data(c.data);b.css({margin:0,padding:0}).after(d),k(),d.append("<ul>"+j+"</ul>");var e=a("ul",d).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),f=a("li",d).attr("unselectable","on"),l=b.attr("size"),m=e.outerHeight(),n=f.outerHeight();void 0!==l&&l>0?e.css({height:n*l}):e.css({height:4*n}),m>d.height()&&(e.css("overflowY","scroll"),h(e),f.filter(".selected").length&&e.scrollTop(e.scrollTop()+f.filter(".selected").position().top)),b.prependTo(d).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0}),b.is(":disabled")?(d.addClass("disabled"),i.each(function(){a(this).is(":selected")&&f.eq(a(this).index()).addClass("selected")})):(f.filter(":not(.disabled):not(.optgroup)").click(function(c){b.focus();var d=a(this);if(c.ctrlKey||c.metaKey||d.addClass("selected"),c.shiftKey||d.addClass("first"),c.ctrlKey||c.metaKey||c.shiftKey||d.siblings().removeClass("selected first"),(c.ctrlKey||c.metaKey)&&(d.is(".selected")?d.removeClass("selected first"):d.addClass("selected first"),d.siblings().removeClass("first")),c.shiftKey){var e=!1,g=!1;d.siblings().removeClass("selected").siblings(".first").addClass("selected"),d.prevAll().each(function(){a(this).is(".first")&&(e=!0)}),d.nextAll().each(function(){a(this).is(".first")&&(g=!0)}),e&&d.prevAll().each(function(){return!a(this).is(".selected")&&void a(this).not(".disabled, .optgroup").addClass("selected")}),g&&d.nextAll().each(function(){return!a(this).is(".selected")&&void a(this).not(".disabled, .optgroup").addClass("selected")}),1==f.filter(".selected").length&&d.addClass("first")}i.prop("selected",!1),f.filter(".selected").each(function(){var b=a(this),c=b.index();b.is(".option")&&(c-=b.prevAll(".optgroup").length),i.eq(c).prop("selected",!0)}),b.change()}),i.each(function(b){a(this).data("optionIndex",b)}),b.on("change.styler",function(){f.removeClass("selected");var b=[];i.filter(":selected").each(function(){b.push(a(this).data("optionIndex"))}),f.not(".optgroup").filter(function(c){return a.inArray(c,b)>-1}).addClass("selected")}).on("focus.styler",function(){d.addClass("focused")}).on("blur.styler",function(){d.removeClass("focused")}),m>d.height()&&b.on("keydown.styler",function(a){38!=a.which&&37!=a.which&&33!=a.which||e.scrollTop(e.scrollTop()+f.filter(".selected").position().top-n),40!=a.which&&39!=a.which&&34!=a.which||e.scrollTop(e.scrollTop()+f.filter(".selected:last").position().top-e.innerHeight()+2*n)}))}var i=a("option",b),j="";if(b.is("[multiple]")){if(f||d)return;m()}else l()};h(),b.on("refresh",function(){b.off(".styler").parent().before(b).remove(),h()})}else b.is(":reset")&&b.on("click",function(){setTimeout(function(){b.closest("form").find("input, select").trigger("refresh")},1)})},destroy:function(){var c=a(this.element);c.is(":checkbox")||c.is(":radio")?(c.removeData("_"+b).off(".styler refresh").removeAttr("style").parent().before(c).remove(),c.closest("label").add('label[for="'+c.attr("id")+'"]').off(".styler")):c.is('input[type="number"]')?c.removeData("_"+b).off(".styler refresh").closest(".jq-number").before(c).remove():(c.is(":file")||c.is("select"))&&c.removeData("_"+b).off(".styler refresh").removeAttr("style").parent().before(c).remove()}},a.fn[b]=function(c){var e=arguments;if(void 0===c||"object"==typeof c)return this.each(function(){a.data(this,"_"+b)||a.data(this,"_"+b,new d(this,c))}).promise().done(function(){var c=a(this[0]).data("_"+b);c&&c.options.onFormStyled.call()}),this;if("string"==typeof c&&"_"!==c[0]&&"init"!==c){var f;return this.each(function(){var g=a.data(this,"_"+b);g instanceof d&&"function"==typeof g[c]&&(f=g[c].apply(g,Array.prototype.slice.call(e,1)))}),void 0!==f?f:this}},e.registered=!1});
